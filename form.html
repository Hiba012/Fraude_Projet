<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø©</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; direction: rtl; background: #f2f2f2; }
    h1 { color: #776fe2; }
    form { background: white; padding: 20px; border-radius: 10px; max-width: 500px; margin: auto; }
    label { display: block; margin: 10px 0 5px; }
    input, select { width: 100%; padding: 8px; margin-bottom: 10px; }
    button { padding: 10px 20px; background: #3498db; color: white; border: none; cursor: pointer; }
    button:hover { background: #2980b9; }
    .result { margin-top: 20px; padding: 15px; border: 1px solid #ddd; background: #f9f9f9; }
  </style>
</head>
<body>
<h1>ğŸ” Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© - Ù…Ø±Ø­Ø¨Ø§ {{ session.user }}</h1>

<form id="fraudForm">
  <label>Ø§Ù„Ù…Ø¨Ù„Øº</label>
  <input type="number" step="0.01" name="Amount" required>

  <label>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</label>
  <select name="TransactionType">
    <option value="Purchase">Ø´Ø±Ø§Ø¡</option>
    <option value="Withdrawal">Ø³Ø­Ø¨</option>
    <option value="Transfer">ØªØ­ÙˆÙŠÙ„</option>
  </select>

  <label>Ø§Ù„Ù…ÙƒØ§Ù†</label>
  <select name="Location">
    <option value="Chicago">Ø´ÙŠÙƒØ§ØºÙˆ</option>
    <option value="Houston">Ù‡ÙŠÙˆØ³ØªÙ†</option>
    <option value="Los Angeles">Ù„ÙˆØ³ Ø£Ù†Ø¬Ù„ÙˆØ³</option>
    <option value="Miami">Ù…ÙŠØ§Ù…ÙŠ</option>
    <option value="New York">Ù†ÙŠÙˆÙŠÙˆØ±Ùƒ</option>
  </select>

  <label>Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²</label>
  <select name="DeviceType">
    <option value="Mobile">Ù‡Ø§ØªÙ</option>
    <option value="Laptop">Ø­Ø§Ø³ÙˆØ¨ Ù…Ø­Ù…ÙˆÙ„</option>
    <option value="ATM">ATM</option>
  </select>

  <label>ÙˆÙ‚Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</label>
  <select name="TimeOfDay">
    <option value="Morning">ØµØ¨Ø§Ø­Ø§</option>
    <option value="Afternoon">Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±</option>
    <option value="Evening">Ù…Ø³Ø§Ø¡</option>
    <option value="Night">Ù„ÙŠÙ„Ø§</option>
  </select>

  <label>Ø¹Ù…Ù„ÙŠØ© Ø§Ø­ØªÙŠØ§Ù„ Ø³Ø§Ø¨Ù‚Ø© (0/1)</label>
  <input type="number" name="PreviousFraud" min="0" max="1" required>

  <label>Ø³Ø±Ø¹Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</label>
  <input type="number" step="0.01" name="TransactionSpeed" required>

  <button type="submit">ØªÙˆÙ‚Ø¹</button>
</form>

<div class="result" id="result"></div>

<script>
document.getElementById("fraudForm").addEventListener("submit", async function(e) {
  e.preventDefault();
  const formData = new FormData(this);
  const payload = {};
  formData.forEach((value, key) => payload[key] = value);

  const response = await fetch("/predict", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  const data = await response.json();
  document.getElementById("result").innerHTML = `
    <h3>Ø§Ù„Ù†ØªÙŠØ¬Ø©:</h3>
    <p>Ø§Ù„ØªÙˆÙ‚Ø¹: <b>${data.prediction}</b></p>
    <p>Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„: <b>${data.fraud_probability?.toFixed(4) ?? "N/A"}</b></p>
  `;
});
</script>

<a href="{{ url_for('transaction_page') }}">Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
<a href="/logout">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
</body>
</html>
